@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  body {
    @apply antialiased bg-background text-text-primary;
    font-family: 'Karla', sans-serif;
    font-weight: 400;
    position: relative;
  }

  body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.03'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 1;
  }

  h1, h2, h3, h4, h5, h6 {
    font-family: 'Epilogue', sans-serif;
  }

  h1 {
    font-weight: 700;
  }

  h2 {
    font-weight: 600;
  }

  h3 {
    font-weight: 500;
  }

  code, pre, .font-mono {
    font-family: 'Space Mono', monospace;
  }
}

@layer utilities {
  /* 3D Transform utilities */
  .perspective-1000 {
    perspective: 1000px;
  }

  .transform-style-3d {
    transform-style: preserve-3d;
  }

  .backface-hidden {
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
  }

  .rotate-y-180 {
    transform: rotateY(180deg);
  }

  /* Fade in animation */
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fadeIn {
    animation: fadeIn 0.6s ease-out;
  }

  /* Fade out animation for year switching */
  @keyframes fadeOut {
    from {
      opacity: 1;
      transform: scale(1);
    }
    to {
      opacity: 0;
      transform: scale(0.95);
    }
  }

  .animate-fadeOut {
    animation: fadeOut 0.3s ease-in forwards;
  }

  /* Staggered fade in animation for year switching */
  @keyframes fadeInStagger {
    from {
      opacity: 0;
      transform: translateY(20px) scale(0.95);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  .animate-fadeInStagger {
    animation: fadeInStagger 0.5s ease-out forwards;
    opacity: 0;
  }

  /* Stagger delay utility classes */
  .stagger-delay-0 { animation-delay: 0ms; }
  .stagger-delay-1 { animation-delay: 50ms; }
  .stagger-delay-2 { animation-delay: 100ms; }
  .stagger-delay-3 { animation-delay: 150ms; }
  .stagger-delay-4 { animation-delay: 200ms; }
  .stagger-delay-5 { animation-delay: 250ms; }
  .stagger-delay-6 { animation-delay: 300ms; }
  .stagger-delay-7 { animation-delay: 350ms; }
  .stagger-delay-8 { animation-delay: 400ms; }
  .stagger-delay-9 { animation-delay: 450ms; }
  .stagger-delay-10 { animation-delay: 500ms; }
  .stagger-delay-11 { animation-delay: 550ms; }
  .stagger-delay-12 { animation-delay: 600ms; }
  .stagger-delay-13 { animation-delay: 650ms; }
  .stagger-delay-14 { animation-delay: 700ms; }
  .stagger-delay-15 { animation-delay: 750ms; }

  /* Sparkle pulse animation */
  @keyframes sparklePulse {
    0%, 100% {
      opacity: 0.3;
      transform: scale(1);
    }
    50% {
      opacity: 0.8;
      transform: scale(1.2);
    }
  }

  .animate-pulse {
    animation: sparklePulse 2s ease-in-out infinite;
  }

  /* Sparkle trail cursor effect */
  @keyframes sparkle {
    0%, 100% {
      opacity: 0;
      transform: scale(0) rotate(0deg);
    }
    50% {
      opacity: 1;
      transform: scale(1) rotate(180deg);
    }
  }

  /* Floating particles */
  @keyframes float {
    0%, 100% {
      transform: translateY(0) translateX(0);
      opacity: 0;
    }
    10% {
      opacity: 0.3;
    }
    90% {
      opacity: 0.3;
    }
    50% {
      transform: translateY(-20px) translateX(10px);
      opacity: 0.5;
    }
  }

  .particle {
    position: fixed;
    pointer-events: none;
    font-size: 8px;
    color: rgba(139, 123, 168, 0.4);
    animation: float 8s infinite ease-in-out;
    z-index: 0;
  }

  /* Page transition */
  @keyframes pageTransition {
    from {
      opacity: 0;
      transform: translateX(20px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  .page-transition {
    animation: pageTransition 0.5s ease-out;
  }

  /* Favorites shelf animations */
  @keyframes favoriteStagger {
    from {
      opacity: 0;
      transform: translateY(30px) scale(0.95);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  .favorite-book-wrapper {
    animation: favoriteStagger 0.6s ease-out forwards;
    opacity: 0;
  }

  /* Favorite book glow effect */
  .favorite-glow {
    position: relative;
  }

  .favorite-glow::before {
    content: '';
    position: absolute;
    inset: -2px;
    border-radius: inherit;
    background: linear-gradient(135deg, rgba(139, 123, 168, 0.3), rgba(139, 123, 168, 0.1));
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: -1;
  }

  .favorite-glow:hover::before {
    opacity: 1;
  }

  /* Enhanced favorite card animation */
  .favorite-book-card-container {
    transition: transform 0.3s ease;
  }

  .favorite-book-card-container:hover {
    transform: translateY(-4px);
  }
}

/* Custom cursor trail */
.cursor-trail {
  position: fixed;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: rgba(139, 123, 168, 0.3);
  pointer-events: none;
  z-index: 9999;
  animation: sparkle 0.5s ease-out forwards;
}

/* Custom scrollbar - Tumblr style */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: #FDFCFA;
}

::-webkit-scrollbar-thumb {
  background: #8B7BA8;
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: #6B5B95;
}

/* Mobile-specific styles */
@layer utilities {
  /* Touch-friendly interactions */
  @media (max-width: 768px) {
    /* Ensure minimum touch target size (44x44px recommended) */
    button,
    a,
    [role="button"],
    .book-card-container,
    .favorite-book-card-container {
      min-height: 44px;
      min-width: 44px;
    }

    /* Prevent text selection on touch interactions */
    .book-card-container,
    .favorite-book-card-container,
    [role="button"] {
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      user-select: none;
      -webkit-user-select: none;
    }

    /* Timeline horizontal scroll with momentum */
    .timeline-scroll-container {
      overflow-x: auto;
      overflow-y: hidden;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: thin;
      scrollbar-color: rgba(139, 123, 135, 0.3) transparent;
      touch-action: pan-x pinch-zoom;
      cursor: grab;
    }
    
    .timeline-scroll-container:active {
      cursor: grabbing;
    }

    .timeline-scroll-container::-webkit-scrollbar {
      height: 6px;
    }

    .timeline-scroll-container::-webkit-scrollbar-track {
      background: transparent;
    }

    .timeline-scroll-container::-webkit-scrollbar-thumb {
      background: rgba(139, 123, 168, 0.3);
      border-radius: 3px;
    }

    /* Prevent double-tap zoom on interactive elements */
    .book-card-container,
    .favorite-book-card-container,
    svg[class*="cursor-pointer"],
    button,
    [role="button"] {
      touch-action: manipulation;
    }

    /* Improve tooltip positioning on mobile */
    .mobile-tooltip {
      max-width: calc(100vw - 24px);
      word-wrap: break-word;
    }

    /* Better spacing for touch interactions */
    .touch-target {
      padding: 8px;
      margin: -8px;
    }
  }

  /* Smooth scrolling for timeline on all devices */
  .timeline-scroll-container {
    scroll-behavior: smooth;
  }

  /* Prevent pull-to-refresh on timeline scroll area */
  @media (max-width: 768px) {
    .timeline-scroll-container {
      overscroll-behavior-x: contain;
    }
  }
}

